<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Party 5 Bingo</title>

<style>
body {
    margin: 0;
    background: #f5d6d2;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    font-family: Arial, sans-serif;
}

/* Responsive container */
.board {
    position: relative;
    width: 90vw;
    max-width: 700px;
}

/* Bingo image */
.board img {
    width: 100%;
    display: block;
}

/* Overlay grid */
.grid {
    position: absolute;
    top: 31%;   /* Adjust if needed */
    left: 10%;   /* Adjust if needed */
    width: 80%;
    height: 63%;
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    grid-template-rows: repeat(5, 1fr);
}

/* Clickable cells */
.cell {
    cursor: pointer;
}

/* Mark effect */
.marked {
    background-color: rgba(0, 200, 0, 0.35);
}

/* FREE space */
.free {
    background-color: rgba(150, 100, 255, 0.35);
}

button {
    margin: 25px 0;
    padding: 12px 28px;
    font-size: 16px;
    font-weight: bold;
    border: none;
    border-radius: 12px;
    cursor: pointer;

    background: linear-gradient(135deg, #ff6b6b, #ff3b3b);
    color: white;

    box-shadow: 0 8px 20px rgba(255, 59, 59, 0.4);
    transition: all 0.3s ease;

    opacity: 0;
    pointer-events: none;
    transform: translateY(10px);
}

/* Visible state */
button.show {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0);
}

/* Hover */
button:hover {
    transform: translateY(-3px);
}


</style>
</head>

<body>

<div class="board">
    <img src="bingo.png" alt="Bingo Card">
    <div class="grid" id="grid"></div>
</div>

<button id="resetBtn" onclick="resetBoard()">ðŸ”„ Reset Raid</button>

<script>
const grid = document.getElementById("grid");
const resetBtn = document.getElementById("resetBtn");
let cells = [];

// Create 25 cells
for (let i = 0; i < 25; i++) {
    const cell = document.createElement("div");
    cell.classList.add("cell");

    if (i === 12) {
        cell.classList.add("marked");
    }

    cell.addEventListener("click", () => {
        if (i !== 12) {
            cell.classList.toggle("marked");
            saveState();
            checkBingo();
        }
    });

    grid.appendChild(cell);
    cells.push(cell);
}

function saveState() {
    const state = cells.map(c => c.classList.contains("marked"));
    localStorage.setItem("bingoState", JSON.stringify(state));
}

function loadState() {
    const saved = JSON.parse(localStorage.getItem("bingoState"));
    if (!saved) return;

    saved.forEach((val, i) => {
        if (val) cells[i].classList.add("marked");
    });
}

function resetBoard() {
    startResetAnimation();
    localStorage.removeItem("bingoState");
    location.reload();
}

function startResetAnimation() {
    const overlay = document.createElement("div");

    overlay.style.position = "fixed";
    overlay.style.top = "0";
    overlay.style.left = "0";
    overlay.style.width = "100%";
    overlay.style.height = "100%";
    overlay.style.background = "black";
    overlay.style.opacity = "0";
    overlay.style.transition = "opacity 0.6s ease";
    overlay.style.zIndex = "2000";

    document.body.appendChild(overlay);

    // Trigger fade in
    setTimeout(() => {
        overlay.style.opacity = "1";
    }, 10);

    // After fade completes
    setTimeout(() => {
        localStorage.removeItem("bingoState");

        // Clear all cells
        cells.forEach((cell, i) => {
            cell.classList.remove("marked");
            cell.style.boxShadow = "none";
            if (i === 12) cell.classList.add("marked"); // FREE stays marked
        });

        resetBtn.classList.remove("show");

        // Fade back out
        overlay.style.opacity = "0";

        setTimeout(() => {
            overlay.remove();
        }, 600);

    }, 700);
}


function checkBingo() {
    const winPatterns = [
        [0,1,2,3,4],
        [5,6,7,8,9],
        [10,11,12,13,14],
        [15,16,17,18,19],
        [20,21,22,23,24],
        [0,5,10,15,20],
        [1,6,11,16,21],
        [2,7,12,17,22],
        [3,8,13,18,23],
        [4,9,14,19,24],
        [0,6,12,18,24],
        [4,8,12,16,20]
    ];

    for (let pattern of winPatterns) {
        if (pattern.every(i => cells[i].classList.contains("marked"))) {
            showBingo(pattern);
            break;
        }
    }
}

function showBingo(pattern) {
    // Highlight winning cells
    pattern.forEach(i => {
        cells[i].style.boxShadow = "0 0 15px gold";
    });

    resetBtn.classList.add("show");

    // Create popup
    const popup = document.createElement("div");
    popup.innerText = "ðŸŽ‰ BINGO! ðŸŽ‰";
    popup.style.position = "fixed";
    popup.style.top = "50%";
    popup.style.left = "50%";
    popup.style.transform = "translate(-50%, -50%)";
    popup.style.fontSize = "48px";
    popup.style.fontWeight = "bold";
    popup.style.color = "white";
    popup.style.background = "rgba(0,0,0,0.8)";
    popup.style.padding = "20px 40px";
    popup.style.borderRadius = "15px";
    popup.style.zIndex = "999";
    popup.style.animation = "pop 0.5s ease";

    document.body.appendChild(popup);

    playSound();
    launchConfetti();
    

    setTimeout(() => {
        popup.remove();
    }, 3000);
}

// Simple victory sound
function playSound() {
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    const notes = [
        { freq: 523, time: 0 },     // C5
        { freq: 659, time: 0.15 },  // E5
        { freq: 784, time: 0.3 },   // G5
        { freq: 1046, time: 0.45 }  // C6 (big finish)
    ];

    notes.forEach(note => {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();

        osc.type = "triangle";
        osc.frequency.value = note.freq;

        osc.connect(gain);
        gain.connect(audioCtx.destination);

        gain.gain.setValueAtTime(0.001, audioCtx.currentTime + note.time);
        gain.gain.exponentialRampToValueAtTime(0.4, audioCtx.currentTime + note.time + 0.02);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + note.time + 0.2);

        osc.start(audioCtx.currentTime + note.time);
        osc.stop(audioCtx.currentTime + note.time + 0.25);
    });
}

// Confetti effect
function launchConfetti() {
    for (let i = 0; i < 40; i++) {
        const confetti = document.createElement("div");
        confetti.style.position = "fixed";
        confetti.style.width = "8px";
        confetti.style.height = "8px";
        confetti.style.backgroundColor = `hsl(${Math.random()*360},100%,50%)`;
        confetti.style.top = "50%";
        confetti.style.left = "50%";
        confetti.style.zIndex = "998";
        confetti.style.borderRadius = "50%";

        document.body.appendChild(confetti);

        const angle = Math.random() * 2 * Math.PI;
        const distance = Math.random() * 400;

        confetti.animate([
            { transform: "translate(0,0)", opacity: 1 },
            { transform: `translate(${Math.cos(angle)*distance}px, ${Math.sin(angle)*distance}px)`, opacity: 0 }
        ], {
            duration: 1200,
            easing: "ease-out"
        });

        setTimeout(() => confetti.remove(), 1200);
    }
}

loadState();
</script>

</body>
</html>
